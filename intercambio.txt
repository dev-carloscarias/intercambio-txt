@using Walmart.FelGTSoft2000.Mvc.Resources.Controls
@using Walmart.FelGTSoft2000.Mvc.Resources.Notifications

@if (@User.Identity.IsAuthenticated)
{
    <div class="col-xl-6 col-lg-5 col-md-5 col-sm-4 col-xs-2 logged-user-container">
        <span class="loggedUser">
            @string.Format("{0}/{1}",
           ((User.Identity as System.Security.Claims.ClaimsIdentity).FindFirst("domain") == null
              ? string.Empty : (User.Identity as System.Security.Claims.ClaimsIdentity).FindFirst("domain").Value),

             ((User.Identity as System.Security.Claims.ClaimsIdentity).FindFirst("username") == null
              ? string.Empty : (User.Identity as System.Security.Claims.ClaimsIdentity).FindFirst("username").Value))
        </span>
        @*<a class="loggedUserIcon" style="text-align: left ">
                <img src="~/Content/Images/header/icono_persona-01.svg" alt="" />
            </a>*@

    </div>

    <div class="col-xl-2 col-lg-3 col-md-3 col-sm-3 col-xs-5">
        <div class="help">
            <select class="form-control form-control-lg mb-3 show-menu-arrow modal-input " style="font-size:18px;" id="countryCode" name="Country" onchange="CountryChange(this, event)">
                <option value="EM" class="h4">@Label.CbCountry</option>
                <option value="GT" class="h4">Guatemala</option>
                <option value="HN" class="h4">Honduras</option>
                <option value="SV" class="h4">El Salvador</option>
                <option value="NI" class="h4">Nicaragua</option>
                <option value="CR" class="h4">Costa Rica</option>
            </select>
        </div>
    </div>



    <div class="col-md-2 col-sm-2 col-xs-5">
        <div class="help">
            <a href="">
                <img src="~/Content/Images/header/ayuda.svg" alt="" />
            </a>
        </div>
        <div class="exit">
            <a style="display: inline" href="@Url.Action("LogOff", "UserAccount")">
                <img src="~/Content/Images/header/salir.svg" alt="" />
            </a>
        </div>
    </div>
}




<script>

    var countryzip = '@Session["Country"]';
    $(document).ready(function () {
        if (countryzip == '' || countryzip == 'EM') {
            document.getElementById("countryCode").value = "EM";
             swal({
                title: @Html.Raw(Json.Encode(Messages.SwalSelectCountryTitle)),
                text: @Html.Raw(Json.Encode(Messages.SwalSelectCountryDescip)),
                type: "warning",
                cancelButtonClass: "btn-primary",
                confirmButtonClass: "btn-success",
                confirmButtonText: @Html.Raw(Json.Encode(Messages.SwalConfirmButtonText)),
                closeOnConfirm: true
            });
        } else {
            document.getElementById("countryCode").value = countryzip;
        }
    });

    function CountryChange(ctl, event) {
        var country = document.getElementById("countryCode").value;

        $.ajax({
            url: '@Url.Action("SetCountry", "Base")',
            data: { country : country},
            type: 'POST',
            success: function (response) {
                location.reload();
            }
        });
    }
</script>
